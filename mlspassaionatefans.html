<section id="passionate-fans">
<!-- Datawrapper-style table (Action Network green + mint theme) -->
<div id="dw-lottery-2" data-dw="table"
     style="--logo-h:34px;
            --stripe:#DCF2EB;              /* mint zebra */
            --hover:#BCE5D6;               /* mint hover */
            --header-bg:#56C257;           /* green header */
            --header-fg:#ffffff;
            --scroll-track:#f7f8fb; 
            --scroll-thumb:#56C257; 
            --scroll-thumb-hover:#3FA94B;
            --gutter: clamp(8px, 4vw, 14px);
            --gutter-left: 0;
            --gutter-right: 0; 
            --edge-pad: 14px;
            --table-max-h: 500px;
            --vbar-w: 6px; --vbar-w-hover: 8px;">
  <style>
  /* Guard: scope box-sizing to this block only */
  #tailgating-states, #tailgating-states * { box-sizing: border-box; }

  /* ===== Datawrapper-style table (Action Network Green + Mint) ===== */
  #dw-lottery-2{
    /* Brand palette (mint + green) */
    --brand-50:#F6FFF9; 
    --brand-100:#DCF2EB;
    --brand-500:#56C257; 
    --brand-600:#3FA94B; 
    --brand-700:#2E8538; 
    --brand-900:#1F5D28;

    --bg:#ffffff; --text:#1f2937;
    box-sizing:border-box; overflow-x:hidden; display:block; max-width:100%;
    padding-left:var(--gutter-left,var(--gutter));
    padding-right:var(--gutter-right,var(--gutter));
  }

  /* Controls layout */
  #dw-lottery-2 .dw-controls{
    display:grid; grid-template-columns:1fr auto 1fr; align-items:center;
    gap:12px; margin:2px 0 10px 0;
  }
  #dw-lottery-2 .left{display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:flex-start}
  #dw-lottery-2 .center{justify-self:center; display:flex; align-items:center}
  #dw-lottery-2 .right{display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:flex-end}

  #dw-lottery-2 .dw-field{position:relative}
  #dw-lottery-2 .dw-input,#dw-lottery-2 .dw-select,#dw-lottery-2 .dw-btn{
    font:14px/1.2 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; border-radius:10px; padding:8px 10px; transition:.15s ease;
  }
  #dw-lottery-2 .dw-input,#dw-lottery-2 .dw-select{
    background:#fff;
    border:1px solid var(--brand-700);         /* green border */
    color:var(--text); box-shadow:inset 0 1px 2px rgba(16,24,40,.04);
  }
  #dw-lottery-2 .dw-input{width:min(320px,100%); padding-right:36px}
  #dw-lottery-2 .dw-input::placeholder{color:#9AA4B2}
  #dw-lottery-2 .dw-input:focus,#dw-lottery-2 .dw-select:focus{
    outline:none; border-color:var(--brand-500);
    box-shadow:0 0 0 3px color-mix(in oklab,var(--brand-500) 25%,transparent); background:#fff;
  }
  #dw-lottery-2 .dw-select{
    appearance:none; padding-right:34px;
    background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%232E8538' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
    background-repeat:no-repeat; background-position:right 10px center; background-size:14px;
  }
  #dw-lottery-2 .dw-btn{background:var(--brand-500); color:#fff; border:1px solid var(--brand-500); padding-inline:12px; cursor:pointer}
  #dw-lottery-2 .dw-btn:hover{background:var(--brand-600); border-color:var(--brand-600)} 
  #dw-lottery-2 .dw-btn:active{transform:translateY(1px)}
  #dw-lottery-2 .dw-btn[disabled]{background:#fafafa; border-color:#d1d5db; color:#6b7280; opacity:1; cursor:not-allowed; transform:none}
  #dw-lottery-2 .dw-status{font:12px/1.2 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; color:#6b7280}
  #dw-lottery-2 .dw-counter{display:none !important;}

  /* Clear button */
  #dw-lottery-2 .dw-clear{
    position:absolute; right:10px; top:50%; translate:0 -50%; width:22px; height:22px; border-radius:9999px; border:0;
    background:transparent; color:var(--brand-700); cursor:pointer; display:none; align-items:center; justify-content:center;
  }
  #dw-lottery-2 .dw-field.has-value .dw-clear{display:flex}
  #dw-lottery-2 .dw-clear:hover{background:var(--brand-100)}

  /* === Top-centre logo (mask + fallback) ======================= */
  #dw-lottery-2 .dw-top-brand{
    display:flex; align-items:center; justify-content:center;
  }

  /* Masked, single-colour logo (exact match to header green) */
  #dw-lottery-2 .dw-top-logo{
    display:block;
    height: clamp(18px, 4.2vw, 28px);
    width: clamp(120px, 16vw, 220px);
    background: var(--header-bg); /* exact fill = #56C257 by default */
    -webkit-mask: var(--logo-url) no-repeat center / contain;
            mask: var(--logo-url) no-repeat center / contain;
  }

  /* <img> fallback (near-exact match using filter) */
  #dw-lottery-2 .dw-top-logo-img{
    display:block;
    height: clamp(18px, 4.2vw, 28px);
    width:auto;
    filter:
      brightness(0) saturate(100%)
      invert(62%) sepia(23%) saturate(1250%) hue-rotate(78deg)
      brightness(96%) contrast(92%);
    image-rendering:-webkit-optimize-contrast;
  }

  /* Prefer mask when available */
  #dw-lottery-2 .dw-top-logo { display: none; }
  #dw-lottery-2 .dw-top-logo-img { display: block; }
  #dw-lottery-2.logo-mask-ok .dw-top-logo { display: block; }
  #dw-lottery-2.logo-mask-ok .dw-top-logo-img { display: none; }

  /* If mask isnâ€™t supported, stay on <img> fallback */
  @supports not (-webkit-mask: url("")){
    #dw-lottery-2 .dw-top-logo{ display:none; }
    #dw-lottery-2 .dw-top-logo-img{ display:block; }
  }

  /* Card & table */
  #dw-lottery-2 .dw-card {
    background: var(--bg);
    border: 0;
    box-shadow: none;
    overflow: hidden;
    margin: 0;
    width: 100%;
  }
  #dw-lottery-2 .dw-scroll {
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
  }
  #dw-lottery-2 .dw-scroll.no-scroll { overflow-x: hidden !important; }
  #dw-lottery-2 table.dw-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    font: 14px/1.45 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    color: var(--text);
    font-variant-numeric: tabular-nums;
    background: transparent;
    min-width: 1200px;
    table-layout: auto;
  }

  /* Header */
  #dw-lottery-2 thead th{
    background:var(--header-bg); color:var(--header-fg,#fff); font-weight:700; text-align:center;
    padding:12px 14px; white-space:nowrap; vertical-align:middle; border:0;
    transition:background-color .15s, color .15s, box-shadow .15s, transform .05s;
  }
  #dw-lottery-2 thead th.sortable{cursor:pointer; user-select:none}
  #dw-lottery-2 thead th.sortable::after{content:"â†•"; font-size:12px; opacity:.75; margin-left:8px; color:var(--header-fg,#fff)}
  #dw-lottery-2 thead th.sortable[data-sort="asc"]::after{content:"â–²"}
  #dw-lottery-2 thead th.sortable[data-sort="desc"]::after{content:"â–¼"}
  #dw-lottery-2 thead th.sortable:hover,#dw-lottery-2 thead th.sortable:focus-visible{background:var(--brand-600); color:#fff; box-shadow:inset 0 -3px 0 var(--brand-100)}
  #dw-lottery-2 .dw-scroll.scrolled thead th{box-shadow:0 6px 10px -6px rgba(0,0,0,.25)}
  #dw-lottery-2 thead th.is-sorted{background:var(--brand-700); color:#fff; box-shadow:inset 0 -3px 0 var(--brand-100)}

  #dw-lottery-2 thead th,
  #dw-lottery-2 tbody td {
    padding: 12px 10px;
    overflow: hidden;
  }
  #dw-lottery-2 thead th { white-space: nowrap; }
  #dw-lottery-2 tbody td:nth-child(2) {
    white-space: normal;          
    word-break: keep-all;         
    overflow-wrap: break-word;
    min-width: 100px;
    max-width: 220px;            
    line-height: 1.3;
  }
  #dw-lottery-2 tbody td {
    background-clip: padding-box;
    backface-visibility: hidden;
    transform: translateZ(0);
  }

  /* Body */
  #dw-lottery-2 tbody td{ text-align:center; vertical-align:middle; background:transparent!important; border:0; transition:background-color .12s }
  #dw-lottery-2 thead th:last-child,#dw-lottery-2 tbody td:last-child{padding-right:14px}
  #dw-lottery-2 tbody tr:nth-child(odd){background:var(--stripe,#DCF2EB)}
  #dw-lottery-2 tbody tr:hover{background:var(--hover,#BCE5D6); box-shadow:inset 3px 0 0 var(--brand-500)}
  #dw-lottery-2 thead th{position:sticky; top:var(--sticky-top,0); z-index:5}

  /* Scrollbar + height */
  #dw-lottery-2 .dw-scroll{max-height:var(--table-max-h,360px); overflow-y:auto; -ms-overflow-style:auto; scrollbar-width:thin; scrollbar-color:var(--scroll-thumb) transparent}
  #dw-lottery-2 .dw-scroll::-webkit-scrollbar:horizontal{height:0; display:none}
  #dw-lottery-2 .dw-scroll::-webkit-scrollbar:vertical{width:var(--vbar-w)}
  #dw-lottery-2 .dw-scroll:hover::-webkit-scrollbar:vertical{width:var(--vbar-w-hover)}
  #dw-lottery-2 .dw-scroll::-webkit-scrollbar-thumb{background:var(--scroll-thumb); border-radius:9999px; border:2px solid transparent; background-clip:content-box}

  /* Dynamic zebra */
  #dw-lottery-2 tbody tr{background:transparent!important}
  #dw-lottery-2 tbody tr.dw-zebra{background:var(--stripe,#DCF2EB)!important}
  #dw-lottery-2 tbody td.is-sorted{background:var(--hover,#BCE5D6)!important; font-weight:600}

  /* Empty-state row */
  #dw-lottery-2 tr.dw-empty td{text-align:center; color:#6b7280; font-style:italic; padding:18px 14px; background:linear-gradient(0deg,#fff,var(--brand-50))}

  /* Footer */
  #dw-lottery-2 .dw-footer{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    padding:10px 0; margin-top:10px; color:#6b7280;
    font:12px/1.25 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
    box-shadow:0 -1px 0 0 color-mix(in oklab,var(--brand-500) 35%, transparent);
  }
  #dw-lottery-2 .dw-brand-left{
    display:none; color:inherit; text-decoration:none; font-weight:600;
    border-bottom:1px dashed transparent; transition:color .15s, border-color .15s;
  }
  #dw-lottery-2 .dw-brand-left:is(:hover,:focus-visible){color:var(--brand-700); border-color:var(--brand-700); outline:none}

  #dw-lottery-2 .dw-controls{
    grid-template-columns: minmax(0,1fr) auto minmax(0,1fr);
    column-gap: 12px;
  }
  #dw-lottery-2 .left,
  #dw-lottery-2 .center,
  #dw-lottery-2 .right { min-width: 0; }
  #dw-lottery-2 .left,
  #dw-lottery-2 .right { flex-wrap: nowrap; }
  #dw-lottery-2 .right { white-space: nowrap; gap: 8px; }
  #dw-lottery-2 .dw-input { width: clamp(160px, 26vw, 320px); }
  #dw-lottery-2 .dw-select { min-width: 68px; }
  #dw-lottery-2 .dw-btn { padding-inline: 8px; }

  @media (min-width:601px) and (max-width:980px){
    #dw-lottery-2 .right > .dw-status{display:inline; font-size:0;}
    #dw-lottery-2 .right > .dw-status::after{content:"Rows"; font-size:12px;}
    #dw-lottery-2 .dw-input { width: clamp(150px, 22vw, 260px); }
  }
  @media (min-width:981px){
    #dw-lottery-2 .dw-top-logo,
    #dw-lottery-2 .dw-top-logo-img { height: 24px; width: auto; }
  }
  @media (max-width: 600px){
    #dw-lottery-2 .dw-controls{
      display:grid;
      grid-template-columns:minmax(0,1fr) auto auto;
      align-items:center; column-gap:8px; row-gap:0; margin:6px 0 8px;
    }
    #dw-lottery-2 .left, #dw-lottery-2 .center, #dw-lottery-2 .right{min-width:0;}
    #dw-lottery-2 .dw-field{width:100%; max-width:46vw;}
    #dw-lottery-2 .dw-input{width:100%; padding:6px 24px 6px 10px; height:34px; font-size:13px;}
    #dw-lottery-2 .dw-clear{width:20px; height:20px;}
    #dw-lottery-2 thead th{ font-size:13px; line-height:1.2; }
    #dw-lottery-2 .dw-top-logo,
    #dw-lottery-2 .dw-top-logo-img{ height:18px; width:120px; } /* 18px on phones */
    #dw-lottery-2 .right{justify-content:flex-end; gap:6px;}
    #dw-lottery-2 .right .dw-status{display:none;}
    #dw-lottery-2 .dw-select{min-width:68px; height:32px; padding:6px 22px 6px 8px; font-size:13px;}
    #dw-lottery-2 .dw-btn{width:32px; height:32px; padding:0; border-radius:12px; display:inline-flex; align-items:center; justify-content:center;}
  }
  </style>

  <!-- Controls -->
  <div class="dw-controls">
    <div class="left">
      <div class="dw-field">
        <input type="search" class="dw-input" placeholder="Search tableâ€¦" aria-label="Search table">
        <button type="button" class="dw-clear" aria-label="Clear search">Ã—</button>
      </div>
      <span class="dw-status dw-counter" aria-live="polite"></span>
    </div>

    <!-- Center: NOT clickable logo -->
    <div class="center">
      <div class="dw-top-brand" aria-label="Brand">
        <div class="dw-top-logo" aria-hidden="true"></div>
        <img class="dw-top-logo-img"
             src="https://i.postimg.cc/x1nG117r/AN-final2-logo.png"
             alt="VegasInsider logo" loading="lazy">
      </div>
    </div>
       
    <div class="right">
      <label class="dw-status" for="dw-size" style="margin-right:4px;">Rows/page</label>
      <select id="dw-size" class="dw-select">
        <option value="10" selected>10</option>
        <option value="15">15</option>
        <option value="20">20</option>
        <option value="0">All</option>
      </select>
      <button class="dw-btn" data-page="prev" aria-label="Previous page">â€¹</button>
      <button class="dw-btn" data-page="next" aria-label="Next page">â€º</button>
    </div>
  </div>

  <div class="dw-card">
  <div class="dw-scroll">
    <table class="dw-table">
      <thead>
        <tr>
          <th scope="col" data-type="num">Rank</th>
          <th scope="col" data-type="text">Team</th>
          <th scope="col" data-type="num">Matchday Support (%)</th>
          <th scope="col" data-type="num">Team Popularity (Monthly Searches)</th>
          <th scope="col" data-type="num">Fan Satisfaction (%)</th>
          <th scope="col" data-type="num">Fan Passion Score (0â€“100)</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>1</td><td>Real Salt Lake City</td><td>99.12%</td><td>90,500</td><td>30.01%</td><td>70.22</td></tr>
        <tr><td>2</td><td>Los Angeles FC</td><td>99.83%</td><td>425,500</td><td>26.76%</td><td>65.69</td></tr>
        <tr><td>3</td><td>Inter Miami CF</td><td>96.62%</td><td>2,035,000</td><td>19.07%</td><td>62.71</td></tr>
        <tr><td>4</td><td>San Diego FC</td><td>80.15%</td><td>139,550</td><td>30.33%</td><td>62.55</td></tr>
        <tr><td>5</td><td>Sporting Kansas City</td><td>89.94%</td><td>100,250</td><td>28.55%</td><td>61.83</td></tr>
        <tr><td>6</td><td>Nashville SC</td><td>91.32%</td><td>92,000</td><td>27.77%</td><td>60.24</td></tr>
        <tr><td>7</td><td>San Jose Earthquakes</td><td>104.37%</td><td>104,500</td><td>23.16%</td><td>53.86</td></tr>
        <tr><td>8</td><td>Minnesota United FC</td><td>99.01%</td><td>55,000</td><td>24.04%</td><td>53.13</td></tr>
        <tr><td>9</td><td>Philadelphia Union</td><td>100.48%</td><td>137,500</td><td>23.15%</td><td>52.38</td></tr>
        <tr><td>10</td><td>FC Dallas</td><td>73.43%</td><td>82,250</td><td>27.66%</td><td>51.14</td></tr>
        <tr><td>11</td><td>New York City FC</td><td>69.39%</td><td>55,000</td><td>28.26%</td><td>50.51</td></tr>
        <tr><td>12</td><td>Austin FC</td><td>100.00%</td><td>122,500</td><td>21.06%</td><td>46.15</td></tr>
        <tr><td>13</td><td>Houston Dynamo FC</td><td>78.47%</td><td>74,000</td><td>24.70%</td><td>45.24</td></tr>
        <tr><td>14</td><td>New York Red Bulls</td><td>74.59%</td><td>74,000</td><td>25.11%</td><td>44.51</td></tr>
        <tr><td>15</td><td>Columbus Crew</td><td>108.86%</td><td>205,500</td><td>18.44%</td><td>44.16</td></tr>
        <tr><td>16</td><td>Vancouver Whitecaps FC</td><td>44.38%</td><td>48,100</td><td>29.73%</td><td>42.41</td></tr>
        <tr><td>17</td><td>Portland Timbers</td><td>88.05%</td><td>112,750</td><td>21.39%</td><td>41.14</td></tr>
        <tr><td>18</td><td>FC Cincinnati</td><td>95.92%</td><td>223,500</td><td>19.06%</td><td>39.85</td></tr>
        <tr><td>19</td><td>Toronto FC</td><td>75.92%</td><td>33,100</td><td>22.96%</td><td>38.66</td></tr>
        <tr><td>20</td><td>Orlando City SC</td><td>83.41%</td><td>57,250</td><td>20.62%</td><td>36.06</td></tr>
        <tr><td>21</td><td>Los Angeles Galaxy</td><td>85.59%</td><td>334,500</td><td>18.94%</td><td>35.90</td></tr>
        <tr><td>22</td><td>Colorado Rapids</td><td>45.91%</td><td>82,250</td><td>26.04%</td><td>33.31</td></tr>
        <tr><td>23</td><td>D.C. United</td><td>86.07%</td><td>110,000</td><td>18.20%</td><td>31.28</td></tr>
        <tr><td>24</td><td>St. Louis CITY SC</td><td>98.94%</td><td>67,250</td><td>15.96%</td><td>30.75</td></tr>
        <tr><td>25</td><td>CF MontrÃ©al</td><td>86.02%</td><td>22,600</td><td>18.33%</td><td>30.52</td></tr>
        <tr><td>26</td><td>New England Revolution</td><td>39.33%</td><td>90,500</td><td>25.39%</td><td>28.41</td></tr>
        <tr><td>27</td><td>Seattle Sounders FC</td><td>44.87%</td><td>75,250</td><td>23.83%</td><td>26.57</td></tr>
        <tr><td>28</td><td>Atlanta United FC</td><td>63.91%</td><td>165,000</td><td>16.49%</td><td>16.48</td></tr>
        <tr><td>29</td><td>Chicago Fire FC</td><td>36.58%</td><td>85,250</td><td>20.75%</td><td>14.09</td></tr>
        <tr><td>30</td><td>Charlotte FC</td><td>43.94%</td><td>150,000</td><td>17.48%</td><td>9.36</td></tr>

        <tr class="dw-empty" style="display:none;"><td colspan="6">No matches found.</td></tr>
      </tbody>
    </table>
  </div>
</div>

   <!-- Optional footer brand name (left) -->
  <div class="dw-footer" role="contentinfo">
    <a class="dw-brand-left" href="#" aria-label="Brand name"></a>
    <span></span>
  </div>
  <script>
  (function(){
    const root = document.getElementById('dw-lottery-2');
    if (!root || root.dataset.dwInit === '1') return;

    function DWTableInit(root){
      root.dataset.dwInit='1';

      const table = root.querySelector('table.dw-table');
      const tb = table ? table.tBodies[0] : null;
      const scroller = root.querySelector('.dw-scroll');
      // Disable horizontal scrolling if the table has 4 or fewer columns
      if (table.tHead && table.tHead.rows[0].cells.length <= 4) {
        scroller.classList.add('no-scroll');
      }
      const controls = root.querySelector('.dw-controls');
      if(!table || !tb || !scroller || !controls) return;

      const field = controls.querySelector('.dw-field');
      const searchInput = controls.querySelector('.dw-input');
      const clearBtn = controls.querySelector('.dw-clear');
      const statusEl = controls.querySelector('.dw-counter'); // hidden
      const sizeSel = controls.querySelector('#dw-size');
      const prevBtn = controls.querySelector('[data-page="prev"]');
      const nextBtn = controls.querySelector('[data-page="next"]');
      const emptyRow = tb.querySelector('.dw-empty');

      /* record original order for "unsort" */
      Array.from(tb.rows).forEach((r,i)=>{ if(!r.classList.contains('dw-empty')) r.dataset.idx=i; });

      let pageSize = parseInt(sizeSel.value,10) || 10;  // 0 = All
      let page = 1;
      let filter = '';

      /* header shadow while scrolled */
      const onScrollShadow = ()=> scroller.classList.toggle('scrolled', scroller.scrollTop > 0);
      scroller.addEventListener('scroll', onScrollShadow); onScrollShadow();

      /* tri-state sorting */
      const heads = Array.from(table.tHead.rows[0].cells);
      heads.forEach((th,i)=>{
        th.classList.add('sortable'); th.setAttribute('aria-sort','none'); th.dataset.sort='none'; th.tabIndex=0;
        const type = th.dataset.type || 'text';
        const go = ()=> sortBy(i,type,th);
        th.addEventListener('click',go);
        th.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); go(); } });
      });

      function textOf(tr,i){ return (tr.children[i].innerText||'').trim(); }
      function clearSortedClasses(){
        heads.forEach(h=>h.classList.remove('is-sorted'));
        Array.from(tb.rows).forEach(r=>Array.from(r.cells).forEach(c=>c.classList.remove('is-sorted')));
      }
      function markSortedColumn(colIdx){
        heads[colIdx]?.classList.add('is-sorted');
        Array.from(tb.rows).forEach(r=>{ const c=r.cells[colIdx]; if(c) c.classList.add('is-sorted'); });
      }

      function sortBy(colIdx, type, th){
        const rows = Array.from(tb.rows).filter(r=>!r.classList.contains('dw-empty'));
        const current = th.dataset.sort || 'none';
        const next = current==='none' ? 'asc' : current==='asc' ? 'desc' : 'none';

        heads.forEach(h=>{ h.dataset.sort='none'; h.setAttribute('aria-sort','none'); h.classList.remove('is-sorted'); });

        if(next === 'none'){
          rows.sort((a,b)=>(+a.dataset.idx)-(+b.dataset.idx));
          rows.forEach(r=>tb.insertBefore(r, emptyRow));
          clearSortedClasses();
          renderPage();
          return;
        }

        th.dataset.sort = next;
        th.setAttribute('aria-sort', next==='asc'?'ascending':'descending');

        const mul = next==='asc'?1:-1;
        rows.sort((a,b)=>{
          let v1=textOf(a,colIdx), v2=textOf(b,colIdx);
          if((type||'text')==='num'){
            v1=parseFloat(v1.replace(/[^0-9.\-]/g,'')); if(isNaN(v1)) v1=-Infinity;
            v2=parseFloat(v2.replace(/[^0-9.\-]/g,'')); if(isNaN(v2)) v2=-Infinity;
          }else{ v1=(v1+'').toLowerCase(); v2=(v2+'').toLowerCase(); }
          if(v1>v2) return 1*mul; if(v1<v2) return -1*mul; return 0;
        });
        rows.forEach(r=>tb.insertBefore(r, emptyRow));
        clearSortedClasses(); markSortedColumn(colIdx);
        renderPage();
      }

      /* zebra */
      function applyZebra(shown){
        Array.from(tb.rows).forEach(r=>r.classList.remove('dw-zebra'));
        shown.forEach((r,idx)=>{ if(idx % 2 === 0) r.classList.add('dw-zebra'); });
      }

      function matchesFilter(tr){ return !tr.classList.contains('dw-empty') && tr.innerText.toLowerCase().includes(filter); }

      function renderPage(){
        const ordered = Array.from(tb.rows).filter(r=>!r.classList.contains('dw-empty'));
        const visible = ordered.filter(matchesFilter);
        const total = visible.length;

        ordered.forEach(r=>r.style.display='none');
        let shown = [];

        if(total===0){
          if(emptyRow){ emptyRow.style.display='table-row'; emptyRow.firstElementChild.colSpan = heads.length; }
          if(statusEl) statusEl.textContent = "";
          prevBtn.disabled = nextBtn.disabled = true;
        }else{
          if(emptyRow) emptyRow.style.display='none';
          if(pageSize===0){
            shown = visible;
            if(statusEl) statusEl.textContent = "";
            prevBtn.disabled = nextBtn.disabled = true;
          }else{
            const pages = Math.max(1, Math.ceil(total / pageSize));
            page = Math.min(Math.max(1, page), pages);
            const start = (page-1)*pageSize, end = start + pageSize;
            shown = visible.slice(start,end);
            if(statusEl) statusEl.textContent = "";
            prevBtn.disabled = page<=1; nextBtn.disabled = page>=pages;
          }
        }

        shown.forEach(r=>r.style.display='table-row');
        applyZebra(shown);
      }

      /* search + clear */
      const syncClearBtn = ()=> field.classList.toggle('has-value', !!searchInput.value);
      let t=null;
      searchInput.addEventListener('input', e=>{
        syncClearBtn();
        clearTimeout(t);
        t=setTimeout(()=>{ filter=(e.target.value||'').toLowerCase().trim(); page=1; renderPage(); },120);
      });
      clearBtn.addEventListener('click', ()=>{ searchInput.value=''; syncClearBtn(); filter=''; page=1; renderPage(); searchInput.focus(); });
      syncClearBtn();

      /* page size + nav */
      sizeSel.addEventListener('change', e=>{ pageSize = parseInt(e.target.value,10) || 0; page=1; renderPage(); });
      prevBtn.addEventListener('click', ()=>{ page--; renderPage(); });
      nextBtn.addEventListener('click', ()=>{ page++; renderPage(); });

      /* ---------- Config ---------- */
      const LOGO_URL   = "https://i.postimg.cc/x1nG117r/AN-final2-logo.png";
      const BRAND_NAME = "";
      const BRAND_HREF = "";
      
      const topWrap = root.querySelector('.dw-top-brand');
      const topLogo = root.querySelector('.dw-top-logo');      // masked version
      const topImg  = root.querySelector('.dw-top-logo-img');  // <img> fallback
      
      if (LOGO_URL) topLogo.style.setProperty('--logo-url', `url("${LOGO_URL}")`);
      topWrap.style.display = 'flex';

      // Only enable the mask route if the browser actually supports it
      const supportsMask =
        (window.CSS && (CSS.supports('mask-image', 'url("")') || CSS.supports('-webkit-mask-image', 'url("")')));

      // Preload the asset then flip the class when ready
      const probe = new Image();
      probe.onload = () => {
        if (supportsMask) {
          const color = (getComputedStyle(root).getPropertyValue('--header-bg') || '#56C257').trim();
          // Ensure masked logo takes the header colour exactly
          topLogo.style.backgroundColor = color;
          topLogo.style.webkitMaskImage  = `url("${LOGO_URL}")`;
          topLogo.style.maskImage        = `url("${LOGO_URL}")`;
          topLogo.style.webkitMaskRepeat = 'no-repeat';
          topLogo.style.maskRepeat       = 'no-repeat';
          topLogo.style.webkitMaskPosition = 'center';
          topLogo.style.maskPosition       = 'center';
          topLogo.style.webkitMaskSize   = 'contain';
          topLogo.style.maskSize         = 'contain';
          root.classList.add('logo-mask-ok');      // switch to masked version
        } else {
          // Stay on <img> + filter fallback
          if (topImg && !topImg.getAttribute('src')) topImg.src = LOGO_URL;
          root.classList.remove('logo-mask-ok');
        }
      };
      probe.onerror = () => {
        // Fall back gracefully to <img>
        if (topImg && !topImg.getAttribute('src')) topImg.src = LOGO_URL;
        root.classList.remove('logo-mask-ok');
      };
      probe.src = LOGO_URL;

      // Footer brand name (optional)
      const footer    = root.querySelector('.dw-footer');
      const brandLeft = root.querySelector('.dw-brand-left');
      if (BRAND_NAME){
        brandLeft.textContent = BRAND_NAME;
        if (BRAND_HREF) brandLeft.href = BRAND_HREF;
        brandLeft.style.display = "inline-block";
      } else {
        footer.style.display = "none";
      }

      /* -------------------------------- */
      renderPage();
    }

    DWTableInit(root);

    /* ---- Auto-resize messaging to parent (iframe) ---- */
    function sendHeightToParent() {
      try {
        const height = document.body.scrollHeight;
        window.parent.postMessage({ type: "resize-iframe", height: height, src: window.location.href }, "*");
      } catch (e) {}
    }
    window.addEventListener("load", sendHeightToParent);
    window.addEventListener("resize", sendHeightToParent);
    const observer = new MutationObserver(sendHeightToParent);
    observer.observe(document.body, { childList: true, subtree: true, attributes: true });
  })();
  </script>
</div>
</section>

<!-- Logo size override moved OUTSIDE the main <style> so it actually applies -->
<style>
  /* Logo size override (desktop wins over earlier media rules) */
  #dw-lottery-2 .dw-top-logo{ height: 64px; width: 260px; }
  #dw-lottery-2 .dw-top-logo-img{ height: 64px; width: auto; }

  @media (max-width: 600px){
    #dw-lottery-2 .dw-top-logo{ height: 44px; width: 160px; }
    #dw-lottery-2 .dw-top-logo-img{ height: 44px; }
  }
</style>

<div style="height: 8px;"></div>

<!-- === Separate embed bar (outside the table) with floating ABOVE popover === -->
<div class="states-embedbar" style="position:relative; text-align:center; margin-top:12px;">
  <button id="states-embed-btn"
          aria-controls="states-embed-pop"
          aria-expanded="false"
          style="background:#56C257;color:#fff;border:1px solid #56C257;border-radius:8px;
                 padding:8px 18px;cursor:pointer;font:14px/1.2 system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
                 transition:.2s ease;">
    ðŸ”— Embed State Table
  </button>

  <!-- Floating popover (initially hidden) -->
  <div id="states-embed-pop"
       role="dialog" aria-modal="false" aria-label="Embed code"
       style="position:absolute; bottom:calc(100% + 10px); left:50%; transform:translateX(-50%);
              display:none; z-index:10000; width:min(620px, calc(100% - 24px));
              padding:10px 16px; border:1px solid #ccc; border-radius:10px; background:#fff;
              box-shadow:0 12px 28px rgba(0,0,0,.18); text-align:left;">
    <textarea id="states-embed-code" readonly
              style="width:100%;height:80px;font:13px monospace;padding:6px 8px;
                     border:1px solid #ddd;border-radius:6px;resize:none;overflow:auto;">
&lt;iframe src="https://gauthambc.github.io/ActionNetwork/mlspassaionatefans.html"
        title="All States Ranking"
        width="100%" height="600"
        style="border:0;" loading="lazy"&gt;&lt;/iframe&gt;
    </textarea>
    <p id="states-copy-status" style="display:none;color:#008000;font-size:13px;margin-top:6px;">Embed code copied!</p>
  </div>
</div>

<!-- Tiny style just for the little arrow under the popover -->
<style>
  #states-embed-pop::after{
    content:"";
    position:absolute;
    left:50%;
    transform:translateX(-50%);
    bottom:-8px;
    border:8px solid transparent;
    border-top-color:#fff;
    filter: drop-shadow(0 1px 1px rgba(0,0,0,.08));
  }
</style>

<script>
  (function(){
    const btn    = document.getElementById('states-embed-btn');
    const pop    = document.getElementById('states-embed-pop');
    const ta     = document.getElementById('states-embed-code');
    const status = document.getElementById('states-copy-status');

    function postResize(){
      try{
        const h = document.body.scrollHeight;
        window.parent.postMessage({ type:'resize-iframe', height:h, src: window.location.href }, '*');
      }catch(e){}
    }

    function openPop(){
      pop.style.display = 'block';
      btn.setAttribute('aria-expanded','true');
      if (ta) {
        ta.select();
        document.execCommand('copy');
        if (status){
          status.style.display = 'block';
          setTimeout(()=>{ status.style.display='none'; }, 2500);
        }
      }
      postResize();
    }
    function closePop(){
      pop.style.display = 'none';
      btn.setAttribute('aria-expanded','false');
      postResize();
    }

    if (btn && pop){
      btn.addEventListener('click', (e)=>{
        e.stopPropagation();
        const isOpen = pop.style.display === 'block';
        if (isOpen) closePop(); else openPop();
      });

      // Click outside closes
      document.addEventListener('click', (e)=>{
        if (pop.style.display === 'block' && !pop.contains(e.target) && e.target !== btn){
          closePop();
        }
      });

      // ESC closes
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape'){ closePop(); } });

      // Keep parent iframe height in sync
      window.addEventListener('resize', postResize);
    }
  })();
</script>
