<section id="tailgating-states"> 
  <!-- Wrapper provides the CSS scope + theme variables -->
  <div id="dw-lottery-2" data-dw="table"
       style="--logo-h:45px;
              --stripe:#DCF2EB;              /* mint stripe */
              --hover:#BCE5D6;               /* hover mint */
              --header-bg:#56C257;           /* green header */
              --header-fg:#ffffff;
              --scroll-track:#f7f8fb; 
              --scroll-thumb:#56C257; 
              --scroll-thumb-hover:#3FA94B;
              --gutter: clamp(8px, 4vw, 14px);
              --gutter-left: 0;
              --gutter-right: 0; 
              --edge-pad: 14px;
              --table-max-h: 500px;
              --vbar-w: 6px; --vbar-w-hover: 8px;">

    <style>
    /* ===== Datawrapper-style table (Action Network Green + Mint theme) ===== */
    #dw-lottery-2{
      /* Brand palette */
      --brand-50:#F6FFF9;
      --brand-100:#DCF2EB;      /* mint stripe */
      --brand-500:#56C257;      /* main green */
      --brand-600:#3FA94B;
      --brand-700:#2E8538;
      --brand-900:#1F5D28;

      --bg:#ffffff; 
      --text:#1f2937;
      box-sizing:border-box; overflow-x:hidden; display:block; max-width:100%;
      padding-left:var(--gutter-left,var(--gutter));
      padding-right:var(--gutter-right,var(--gutter));
    }

    /* Controls layout — compact pattern (desktop + mobile) */
    #dw-lottery-2 .dw-controls{
      display:grid;
      grid-template-columns: auto 1fr auto;         /* search | logo | rows/page */
      align-items:center;
      gap:12px; margin:2px 0 10px 0;
    }
    #dw-lottery-2 .left{
      display:flex; gap:8px; align-items:center; flex-wrap:nowrap; justify-content:flex-start;
      min-width:0;                                   /* allow shrinking */
    }
    #dw-lottery-2 .center{justify-self:center; display:flex; align-items:center; justify-content:center;}
    #dw-lottery-2 .right{
      display:flex; gap:8px; align-items:center; flex-wrap:nowrap; justify-content:flex-end;
      min-width:0;
    }
    /* keep right cluster tidy and narrow */
    #dw-lottery-2 .right label{ display:none; }      /* hide label to save width */
    #dw-lottery-2 .right select,
    #dw-lottery-2 .right button { vertical-align: middle; }

    /* Search field: cap the width so it’s not too long on desktop */
    #dw-lottery-2 .dw-field{ position:relative; flex:0 0 auto; }
    #dw-lottery-2 .dw-input,#dw-lottery-2 .dw-select,#dw-lottery-2 .dw-btn{
      font:14px/1.2 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; 
      border-radius:10px; padding:8px 10px; transition:.15s ease;
    }
    #dw-lottery-2 .dw-input,#dw-lottery-2 .dw-select{
      background:#fff;
      border:1px solid var(--brand-700);         /* green border */
      color:var(--text); box-shadow:inset 0 1px 2px rgba(16,24,40,.04);
    }
    #dw-lottery-2 .dw-input{ width:clamp(260px, 32vw, 360px); padding-right:36px; }
    #dw-lottery-2 .dw-input::placeholder{color:#9AA4B2}
    #dw-lottery-2 .dw-input:focus,#dw-lottery-2 .dw-select:focus{
      outline:none; border-color:var(--brand-500);
      box-shadow:0 0 0 3px color-mix(in oklab,var(--brand-500) 25%,transparent); background:#fff;
    }
    #dw-lottery-2 .dw-select{
      appearance:none; padding-right:34px; min-width:58px;    /* keeps visible on mobile */
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%232E8538' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
      background-repeat:no-repeat; background-position:right 10px center; background-size:14px;
    }
    #dw-lottery-2 .dw-btn{
      background:var(--brand-500); color:#fff; border:1px solid var(--brand-500); 
      padding-inline:12px; cursor:pointer;
    }
    #dw-lottery-2 .dw-btn:hover{background:var(--brand-600); border-color:var(--brand-600)} 
    #dw-lottery-2 .dw-btn:active{transform:translateY(1px)}
    #dw-lottery-2 .dw-btn[disabled]{background:#fafafa; border-color:#d1d5db; color:#6b7280; opacity:1; cursor:not-allowed; transform:none}
    #dw-lottery-2 .dw-status{font:12px/1.2 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; color:#6b7280}
    #dw-lottery-2 .dw-counter{display:none !important;}

    /* Clear button */
    #dw-lottery-2 .dw-clear{
      position:absolute; right:10px; top:50%; translate:0 -50%; width:22px; height:22px; border-radius:9999px; border:0;
      background:transparent; color:var(--brand-700); cursor:pointer; display:none; align-items:center; justify-content:center;
    }
    #dw-lottery-2 .dw-field.has-value .dw-clear{display:flex}
    #dw-lottery-2 .dw-clear:hover{background:var(--brand-100)}

    /* Top-center logo (masked) */
    #dw-lottery-2 .dw-top-brand{display:none; align-items:center}
    #dw-lottery-2 .dw-top-logo{
      display:block;
      height:24px;                /* desktop/tablet height */
      aspect-ratio:200/24;
      width:auto;
      margin:0 auto;              /* truly centered */
      background:var(--brand-500);
      -webkit-mask: var(--logo-url) no-repeat center / contain;
              mask: var(--logo-url) no-repeat center / contain;
    }

    /* Card & table */
    #dw-lottery-2 .dw-card { background: var(--bg); border: 0; box-shadow: none; overflow: hidden; margin: 0; width: 100%; }
    #dw-lottery-2 .dw-scroll { overflow-x: auto; overflow-y: hidden; -webkit-overflow-scrolling: touch; }
    #dw-lottery-2 .dw-scroll.no-scroll { overflow-x: hidden !important; }
    #dw-lottery-2 table.dw-table {
      width: 100%; border-collapse: separate; border-spacing: 0;
      font: 14px/1.45 system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
      color: var(--text); font-variant-numeric: tabular-nums; background: transparent;
      min-width: 1200px; table-layout: auto;
    }

    /* Header */
    #dw-lottery-2 thead th{
      background:var(--header-bg,#56C257); 
      color:var(--header-fg,#ffffff); 
      font-weight:700; text-align:center;
      padding:12px 14px; white-space:nowrap; vertical-align:middle; border:0;
      transition:background-color .15s, color .15s, box-shadow .15s, transform .05s;
    }
    #dw-lottery-2 thead th.sortable{cursor:pointer; user-select:none}
    #dw-lottery-2 thead th.sortable::after{content:"↕"; font-size:12px; opacity:.75; margin-left:8px; color:var(--header-fg,#fff)}
    #dw-lottery-2 thead th.sortable[data-sort="asc"]::after{content:"▲"}
    #dw-lottery-2 thead th.sortable[data-sort="desc"]::after{content:"▼"}
    #dw-lottery-2 thead th.sortable:hover,#dw-lottery-2 thead th.sortable:focus-visible{background:var(--brand-600); color:#fff; box-shadow:inset 0 -3px 0 var(--brand-100)}
    #dw-lottery-2 .dw-scroll.scrolled thead th{box-shadow:0 6px 10px -6px rgba(0,0,0,.25)}
    #dw-lottery-2 thead th.is-sorted{background:var(--brand-700); color:#fff; box-shadow:inset 0 -3px 0 var(--brand-100)}

    /* Body */
    #dw-lottery-2 tbody td{ text-align:center; vertical-align:middle; background:transparent!important; border:0; transition:background-color .12s }
    #dw-lottery-2 thead th{position:sticky; top:var(--sticky-top,0); z-index:5}

    /* Scrollbar */
    #dw-lottery-2 .dw-scroll{max-height:var(--table-max-h,360px); overflow-y:auto; -ms-overflow-style:auto; scrollbar-width:thin; scrollbar-color:var(--scroll-thumb,#56C257) transparent}
    #dw-lottery-2 .dw-scroll::-webkit-scrollbar:vertical{width:8px}
    #dw-lottery-2 .dw-scroll::-webkit-scrollbar-thumb{background:var(--scroll-thumb,#56C257); border-radius:9999px;}

    /* ✅ Dynamic zebra + sorted column highlight (works with paging/filtering) */
    #dw-lottery-2 tbody tr{background:transparent!important}
    #dw-lottery-2 tbody tr.dw-zebra{background:var(--stripe,#DCF2EB)!important}
    #dw-lottery-2 tbody tr:hover{background:var(--hover,#BCE5D6)!important; box-shadow:inset 3px 0 0 var(--brand-500)}
    #dw-lottery-2 tbody td.is-sorted{background:var(--hover,#BCE5D6)!important; font-weight:600}

    /* Footer */
    #dw-lottery-2 .dw-footer{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:10px 0; margin-top:10px; color:#6b7280;
      font:12px/1.25 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
      box-shadow:0 -1px 0 0 color-mix(in oklab,var(--brand-500) 35%, transparent);
    }
    #dw-lottery-2 .dw-brand-left{display:none; color:inherit; text-decoration:none; font-weight:600;}

    /* ---------- UPDATED MOBILE TUNING ---------- */

    /* Phones and small tablets (<=600px): keep everything on one row without overlap */
    @media (max-width: 600px){
      #dw-lottery-2 .dw-controls{
        grid-template-columns: minmax(140px,1fr) auto auto; /* search | logo | rows/page */
        gap:6px;
        margin:6px 0 8px;
      }

      /* smaller search */
      #dw-lottery-2 .dw-input{
        width:clamp(140px, 46vw, 200px);
        padding:6px 24px 6px 10px;
        height:32px;
        font-size:12.5px;
      }

      /* smaller centered logo */
      #dw-lottery-2 .dw-top-logo{ height:16px; }

      /* compact rows/page select + nav buttons */
      #dw-lottery-2 .dw-select{
        min-width:56px;
        height:32px;
        font-size:12.5px;
        padding-right:28px;
        background-position:right 8px center;
        background-size:12px;
      }
      #dw-lottery-2 .dw-btn{ padding:6px 10px; }
      
      #dw-lottery-2 thead th{ font-size:13px; line-height:1.2; }
    }

    /* Very narrow phones (<=480px): wrap to two rows so nothing overlaps */
    @media (max-width: 480px){
      #dw-lottery-2 .dw-controls{ grid-template-columns: 1fr 1fr; }
      #dw-lottery-2 .left{   grid-column:1 / -1; }         /* search spans full width (row 1) */
      #dw-lottery-2 .center{ grid-column:1 / 2; justify-self:start; }  /* row 2, left */
      #dw-lottery-2 .right{  grid-column:2 / 3; justify-self:end; }    /* row 2, right */
    }
    </style>

    <!-- Controls -->
    <div class="dw-controls">
      <div class="left">
        <div class="dw-field">
          <input type="search" class="dw-input" placeholder="Search table…" aria-label="Search table">
          <button type="button" class="dw-clear" aria-label="Clear search">×</button>
        </div>
        <span class="dw-status dw-counter" aria-live="polite"></span>
      </div>

      <!-- Center: NOT clickable logo -->
      <div class="center">
        <div class="dw-top-brand" aria-label="Brand">
          <div class="dw-top-logo" aria-hidden="true"></div>
        </div>
      </div>

      <div class="right">
        <label class="dw-status" for="dw-size" style="margin-right:4px;">Rows/page</label>
        <select id="dw-size" class="dw-select">
          <option value="10" selected>10</option>
          <option value="15">15</option>
          <option value="20">20</option>
          <option value="0">All</option>
        </select>
        <button class="dw-btn" data-page="prev" aria-label="Previous page">‹</button>
        <button class="dw-btn" data-page="next" aria-label="Next page">›</button>
      </div>
    </div>

    <!-- Table -->
    <div class="dw-card">
      <div class="dw-scroll">
        <table class="dw-table">
          <thead>
            <tr>
              <th scope="col" data-type="num">Rank</th>
              <th scope="col" data-type="text">State</th>
              <th scope="col" data-type="num">Tailgating Score (/100)</th>
              <th scope="col" data-type="num">Beer ($/6-pack)</th>
              <th scope="col" data-type="num">BBQ Fuel Cost ($/bag)</th>
              <th scope="col" data-type="num">Meat Price ($/lb)</th>
              <th scope="col" data-type="num">Game-Day Parking ($)</th>
              <th scope="col" data-type="num">Stadium Parking Spaces (Est.)</th>
              <th scope="col" data-type="num">No. of CFB & NFL Teams</th>
              <th scope="col" data-type="num">Fan Sentiment (Positive %)</th>
              <th scope="col" data-type="num">Fan Interest (Monthly Searches)</th>
            </tr>
          </thead>
          <tbody>
            <!-- YOUR ROWS (unchanged) -->
            <tr><td>1</td><td>Texas</td><td>78.66</td><td>5.43</td><td>13.86</td><td>4.36</td><td>21.87</td><td>97241</td><td>15</td><td>59.70</td><td>7470</td></tr>
            <tr><td>2</td><td>South Carolina</td><td>58.67</td><td>4.13</td><td>11.83</td><td>4.36</td><td>17.44</td><td>28884</td><td>3</td><td>69.37</td><td>1000</td></tr>
            <!-- … (rest of rows) … -->
            <tr><td>42</td><td>Massachusetts</td><td>29.18</td><td>4.91</td><td>16.46</td><td>4.38</td><td>40.90</td><td>15943</td><td>3</td><td>46.08</td><td>940</td></tr>

            <!-- optional empty-state row -->
            <tr class="dw-empty" style="display:none;"><td colspan="11">No matches found.</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Optional footer brand name (left) -->
    <div class="dw-footer" role="contentinfo">
      <a class="dw-brand-left" href="#" aria-label="Brand name"></a>
      <span></span>
    </div>

    <script>
    (function(){
      if(!window.DWTableInit){
        window.DWTableInit = function init(root){
          if(!root || root.dataset.dwInit==='1') return;
          root.dataset.dwInit='1';

          const table = root.querySelector('table.dw-table');
          const tb = table ? table.tBodies[0] : null;
          const scroller = root.querySelector('.dw-scroll');
          const controls = root.querySelector('.dw-controls');
          if(!table || !tb || !scroller || !controls) return;

          // Disable horizontal scrolling if the table has 4 or fewer columns
          if (table.tHead && table.tHead.rows[0].cells.length <= 4) {
            scroller.classList.add('no-scroll');
          }

          const field = controls.querySelector('.dw-field');
          const searchInput = controls.querySelector('.dw-input');
          const clearBtn = controls.querySelector('.dw-clear');
          const statusEl = controls.querySelector('.dw-counter'); // hidden
          const sizeSel = controls.querySelector('#dw-size');
          const prevBtn = controls.querySelector('[data-page="prev"]');
          const nextBtn = controls.querySelector('[data-page="next"]');
          const emptyRow = tb.querySelector('.dw-empty');

          /* record original order for "unsort" */
          Array.from(tb.rows).forEach((r,i)=>{ if(!r.classList.contains('dw-empty')) r.dataset.idx=i; });

          let pageSize = parseInt(sizeSel.value,10) || 10;  // 0 = All
          let page = 1;
          let filter = '';

          /* header shadow while scrolled */
          const onScrollShadow = ()=> scroller.classList.toggle('scrolled', scroller.scrollTop > 0);
          scroller.addEventListener('scroll', onScrollShadow); onScrollShadow();

          /* tri-state sorting */
          const heads = Array.from(table.tHead.rows[0].cells);
          heads.forEach((th,i)=>{
            th.classList.add('sortable'); th.setAttribute('aria-sort','none'); th.dataset.sort='none'; th.tabIndex=0;
            const type = th.dataset.type || 'text';
            const go = ()=> sortBy(i,type,th);
            th.addEventListener('click',go);
            th.addEventListener('keydown',e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); go(); } });
          });

          function textOf(tr,i){ return (tr.children[i].innerText||'').trim(); }
          function clearSortedClasses(){
            heads.forEach(h=>h.classList.remove('is-sorted'));
            Array.from(tb.rows).forEach(r=>Array.from(r.cells).forEach(c=>c.classList.remove('is-sorted')));
          }
          function markSortedColumn(colIdx){
            heads[colIdx]?.classList.add('is-sorted');
            Array.from(tb.rows).forEach(r=>{ const c=r.cells[colIdx]; if(c) c.classList.add('is-sorted'); });
          }

          function sortBy(colIdx, type, th){
            const rows = Array.from(tb.rows).filter(r=>!r.classList.contains('dw-empty'));
            const current = th.dataset.sort || 'none';
            const next = current==='none' ? 'asc' : current==='asc' ? 'desc' : 'none';

            heads.forEach(h=>{ h.dataset.sort='none'; h.setAttribute('aria-sort','none'); h.classList.remove('is-sorted'); });

            if(next === 'none'){
              rows.sort((a,b)=>(+a.dataset.idx)-(+b.dataset.idx));
              rows.forEach(r=>tb.insertBefore(r, emptyRow));
              clearSortedClasses();
              renderPage();
              return;
            }

            th.dataset.sort = next;
            th.setAttribute('aria-sort', next==='asc'?'ascending':'descending');

            const mul = next==='asc'?1:-1;
            rows.sort((a,b)=>{
              let v1=textOf(a,colIdx), v2=textOf(b,colIdx);
              if((type||'text')==='num'){
                v1=parseFloat(v1.replace(/[^0-9.\-]/g,'')); if(isNaN(v1)) v1=-Infinity;
                v2=parseFloat(v2.replace(/[^0-9.\-]/g,'')); if(isNaN(v2)) v2=-Infinity;
              }else{ v1=(v1+'').toLowerCase(); v2=(v2+'').toLowerCase(); }
              if(v1>v2) return 1*mul; if(v1<v2) return -1*mul; return 0;
            });
            rows.forEach(r=>tb.insertBefore(r, emptyRow));
            clearSortedClasses(); markSortedColumn(colIdx);
            renderPage();
          }

          /* zebra using visible rows */
          function applyZebra(shown){
            Array.from(tb.rows).forEach(r=>r.classList.remove('dw-zebra'));
            shown.forEach((r,idx)=>{ if(idx % 2 === 0) r.classList.add('dw-zebra'); });
          }

          function matchesFilter(tr){ return !tr.classList.contains('dw-empty') && tr.innerText.toLowerCase().includes(filter); }

          function renderPage(){
            const ordered = Array.from(tb.rows).filter(r=>!r.classList.contains('dw-empty'));
            const visible = ordered.filter(matchesFilter);
            const total = visible.length;

            ordered.forEach(r=>r.style.display='none');
            let shown = [];

            if(total===0){
              if(emptyRow){ emptyRow.style.display='table-row'; emptyRow.firstElementChild.colSpan = heads.length; }
              if(statusEl) statusEl.textContent = "";
              prevBtn.disabled = nextBtn.disabled = true;
            }else{
              if(emptyRow) emptyRow.style.display='none';
              if(pageSize===0){
                shown = visible;
                if(statusEl) statusEl.textContent = "";
                prevBtn.disabled = nextBtn.disabled = true;
              }else{
                const pages = Math.max(1, Math.ceil(total / pageSize));
                page = Math.min(Math.max(1, page), pages);
                const start = (page-1)*pageSize, end = start + pageSize;
                shown = visible.slice(start,end);
                if(statusEl) statusEl.textContent = "";
                prevBtn.disabled = page<=1; nextBtn.disabled = page>=pages;
              }
            }

            shown.forEach(r=>r.style.display='table-row');
            applyZebra(shown);
          }

          /* search + clear */
          const syncClearBtn = ()=> field.classList.toggle('has-value', !!searchInput.value);
          let t=null;
          searchInput.addEventListener('input', e=>{
            syncClearBtn();
            clearTimeout(t);
            t=setTimeout(()=>{ filter=(e.target.value||'').toLowerCase().trim(); page=1; renderPage(); },120);
          });
          clearBtn.addEventListener('click', ()=>{ searchInput.value=''; syncClearBtn(); filter=''; page=1; renderPage(); searchInput.focus(); });
          syncClearBtn();

          /* page size + nav */
          sizeSel.addEventListener('change', e=>{ pageSize = parseInt(e.target.value,10) || 0; page=1; renderPage(); });
          prevBtn.addEventListener('click', ()=>{ page--; renderPage(); });
          nextBtn.addEventListener('click', ()=>{ page++; renderPage(); });

          /* ---------- Config ---------- */
          const LOGO_URL   = "https://i.postimg.cc/sg4WBxD9/Action-Network-Logo.png"; // logo mask
          const BRAND_NAME = "";
          const BRAND_HREF = "";

          // Top logo (set mask CSS var & show wrapper)
          const topWrap = root.querySelector('.dw-top-brand');
          const topLogo = root.querySelector('.dw-top-logo');
          if (LOGO_URL){
            topLogo.style.setProperty('--logo-url', `url("${LOGO_URL}")`);
            topWrap.style.display = "flex";
          }

          // Footer brand name (optional)
          const footer = root.querySelector('.dw-footer');
          const brandLeft = root.querySelector('.dw-brand-left');
          if (BRAND_NAME){
            brandLeft.textContent = BRAND_NAME;
            if (BRAND_HREF) brandLeft.href = BRAND_HREF;
            brandLeft.style.display = "inline-block";
          } else {
            footer.style.display = "none";
          }

          renderPage();
        };
        document.querySelectorAll('[data-dw="table"]').forEach(root=>window.DWTableInit(root));
      }
      window.DWTableInit(document.getElementById('dw-lottery-2'));
    })();
    </script>
  </div> <!-- /#dw-lottery-2 wrapper -->
</section>

<div style="height: 4px;"></div>

<!-- Embed button placed AFTER section -->
<div class="embed-container" style="text-align:center;margin-top:12px;">
  <button id="copy-embed-btn"
          style="background:#56C257;color:#fff;border:1px solid #56C257;border-radius:8px;
                 padding:8px 18px;cursor:pointer;font:14px/1.2 system-ui,-apple-system,'Segoe UI',Roboto,Arial,sans-serif;
                 transition:.2s ease;">
    🔗Embed This Table
  </button>

  <div id="embed-wrapper" 
       style="display:none;margin:14px auto 0;max-width:620px;padding:10px 16px;
              border:1px solid #ccc;border-radius:10px;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.08);">
    <textarea id="embed-code" readonly
              style="width:100%;height:80px;font:13px monospace;padding:6px 8px;
                     border:1px solid #ddd;border-radius:6px;resize:none;overflow:auto;">
&lt;iframe src="https://gauthambc.github.io/tailgating-State-Table/"
        title="Top Tailgating States"
        width="100%" height="550"
        style="border:0;" loading="lazy"&gt;&lt;/iframe&gt;
    </textarea>
    <p id="copy-status" style="display:none;color:#008000;font-size:13px;margin-top:6px;">Embed code copied!</p>
  </div>
</div>

<script>
  const btn = document.getElementById('copy-embed-btn');
  const wrapper = document.getElementById('embed-wrapper');
  const ta = document.getElementById('embed-code');
  const status = document.getElementById('copy-status');

  if (btn && ta && wrapper && status) {
    btn.addEventListener('click', () => {
      const isHidden = wrapper.style.display === 'none' || wrapper.style.display === '';
      wrapper.style.display = isHidden ? 'block' : 'none';
      btn.textContent = isHidden ? 'Hide Embed Code' : '🔗Embed This Table';
      if (isHidden) {
        ta.select();
        document.execCommand('copy');
        status.style.display = 'block';
        status.textContent = 'Embed code copied!';
        setTimeout(() => status.style.display = 'none', 2500);
      }
    });
</script>
